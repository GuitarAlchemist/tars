namespace TarsEngine.Models;

/// <summary>
/// Represents a security vulnerability in code
/// </summary>
public class SecurityVulnerability
{
    /// <summary>
    /// Gets or sets the vulnerability ID
    /// </summary>
    public string Id { get; set; } = Guid.NewGuid().ToString();

    /// <summary>
    /// Gets or sets the vulnerability name
    /// </summary>
    public string Name { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the vulnerability description
    /// </summary>
    public string Description { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the vulnerability severity
    /// </summary>
    public SecurityVulnerabilitySeverity Severity { get; set; }

    /// <summary>
    /// Gets or sets the vulnerability location
    /// </summary>
    public string Location { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the line number where the vulnerability was found
    /// </summary>
    public int LineNumber { get; set; }

    /// <summary>
    /// Gets or sets the column number where the vulnerability was found
    /// </summary>
    public int ColumnNumber { get; set; }

    /// <summary>
    /// Gets or sets the code snippet containing the vulnerability
    /// </summary>
    public string CodeSnippet { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the recommended fix for the vulnerability
    /// </summary>
    public string RecommendedFix { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the CWE (Common Weakness Enumeration) ID
    /// </summary>
    public string CweId { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the OWASP (Open Web Application Security Project) category
    /// </summary>
    public string OwaspCategory { get; set; } = string.Empty;

    /// <summary>
    /// Gets or sets the references for the vulnerability
    /// </summary>
    public List<string> References { get; set; } = new();
}

/// <summary>
/// Represents the severity of a security vulnerability
/// </summary>
public enum SecurityVulnerabilitySeverity
{
    /// <summary>
    /// Low severity
    /// </summary>
    Low,

    /// <summary>
    /// Medium severity
    /// </summary>
    Medium,

    /// <summary>
    /// High severity
    /// </summary>
    High,

    /// <summary>
    /// Critical severity
    /// </summary>
    Critical
}
